\documentclass[../../master.tex]{subfiles}
\begin{document}
\renewcommand{\R}{{\bf R}}
\renewcommand{\r}{{\bf r}}
\newcommand{\x}{{\bf x}}
\newcommand{\psiz}{|\Psi_0\rangle}


\chapter{Hartree-Fock \label{HF}}
The Hartree-Fock (HF) method is one of the most important models in all of quantum chemistry, not only because it may yield acceptable approximations in certain scenarios, but because it is also an important stepping stone on the way to more accurate methods. Only a few of the more sophisticated quantum chemistry methods bypass HF entirely, while \emph{most} of them use it as a first step and then build on the HF orbitals to obtain more accurate descriptions \cite{szabo}\comment{p108}. In particular, for larger systems, the Hartree-Fock approach may be the only feasible one and it is the only approximate method that is \emph{routinely} being applied to \emph{large} systems of several hundred atoms and molecules \cite{helgaker}\comment{p433}.

The Hartree-Fock method is a \emph{mean field} method in that it treats the inter electron interaction only in an averaged way \cite{kvaal}\comment{p44}. Any single electron does not feel the effect of every other localized electron, but rather just an averaged potential from all other remaining ones. This is sometimes also called an \emph{independent-particle} model. The Hartree-Fock approximation usually \emph{defines} the dynamical coulomb correlation between electrons by saying the difference between the Hartree-Fock energy and the exact quantum mechanical energy is the correlation energy. Hartree-Fock nevertheless deals exactly with the electron correlations arising from the anti-symmetry condition of Pauli, namely the exchange correlations. 

In essence, the Hartree-Fock procedure finds the most energetically favorable electronic configuration under the assumption that the full ground state wave function consists of a \emph{single} Slater determinant populated by orthonormal spin-orbitals. In older litterature, the HF method is often called \emph{self-consitent field} method due to the way the resulting equations are usually solved \cite{levine}\comment{p292}. However, the self-consistent field iterations are not the \emph{only} way to solve the HF equations, and thus not an essential part of the method itself \cite{helgaker}\comment{433}.

In the following we will apply the variational principle to the single Slater determinant ansatz wave function for the interacting system of $N$ electrons. We will then expand the solution in a given basis and derive the Roothan-Hall and Pople-Nesbet equations, for the closed-shell and open-shell systems respectively. 


\section{Single Slater determinant ansatz}
The method itself essentially finds the most energetically favorable electronic wave function, under the assumption that the full ground state consists of \emph{a single} Slater determinant populated by orthonormal spin-orbitals, $\phi_i$. We denote this Slater determinant $|\Psi\rangle$,
\begin{align}
|\Psi\rangle &= |\phi_0\phi_1\phi_2\dots\phi_{N-1}\phi_{N}\rangle, \ \ \ \langle \phi_i|\phi_j\rangle = \delta_{ij}.
\end{align}
We may write down an explicit expression for the determinantal wave function in the position basis as 
\begin{align}
\Psi(\x_1,\x_2,\dots,\x_N) &= \frac{1}{\sqrt{N!}}\vmat{cccc}
{
  \phi_1(\x_1)  & \phi_2(\x_1)  & \dots   & \phi_N(\x_1)  \\
  \phi_1(\x_2)  & \phi_2(\x_2)  & \dots   & \phi_N(\x_2)  \\
  \vdots        & \vdots        & \ddots  & \vdots        \\
  \phi_1(\x_N)  & \phi_2(\x_N)  & \dots   & \phi_N(\x_N)
},
\end{align}
with $\phi_n(\x_k)$ being the index $n$ spin-orbital evaluated at the spatial and spin-projection coordinates $\x_k$. Under the assumption that the spin-orbitals themselves are orthonormal, the total determinant will also be normalized in the sense that $\langle \Phi|\Phi\rangle=1$ \cite{kvaal}\comment{p44}.

Recall from section ((Born-Oppenheimer section)) that the Born-Oppenheimer Hamiltonian for a system of $N$ electrons subject to the Coulomb potential from $M$ atoms takes the form
\begin{align}
\hat H &= \underbrace{\sum_{i=1}^N -\frac{\nabla^2}{2} + \sum_{i=1}^N\sum_{A=1}^M -\frac{Z_A}{|\r_A-\r_i|}} + \sum_{i=1}^N \sum_{j=i+1}^N \frac{1}{|\r_i-\r_j|} \nn\\
%
&\equiv \phantom{------}\sum_{i=1}^N \hat h_i \phantom{-----}+ \sum_{i=1}^N\sum_{j=i+1}^N\hat w_{ij}, 
\end{align}
where we have defined the \emph{one-body operator} $\hat h_i=-\nabla^2/2-\sum_AZ_A/|\r_A-\r_i|$. The \emph{two-body operator} $\hat w_{ij}$ represents the Coulombic electron-electron interaction between electrons labelled $i$ and $j$. 



\subsection{Exchange correlation}
With only applying the Slater determinant ansatz, the electrons are already correlated. If we consider the probability of finding two electrons at coordinates $\x_1$ and $\x_2$ respectively, \cite{thijssen}\comment{p53}
\begin{align}
\rho(\x_1,\x_2) &= \int\mathrm{d}\x_3\,\mathrm{d}\x_4\,\dots\,\mathrm{d}\x_N\,|\Psi(\x_1,\x_2,\dots,\x_N)|^2 \nn\\
%
&= \frac{1}{N(N-1)}\sum_{k=1}^N\sum_{l=1}^N \Big[ |\phi_k(\x_1)|^2 |\phi_l(\x_2)|^2 - \phi^*_k(\x_1)\phi_k(\x_2)\phi_l^*(\x_2)\phi_l(\x_1)\Big]. \label{eq:exchange}
\end{align}
In order to relate this to spatial coordinates only, we need to sum over the spin variables,
\begin{align}
\rho(\r_1,\r_2) &= \sum_{s_1}\sum_{s_2} \rho(\x_1,\x_2),
\end{align}
which means the second term vanishes for opposite spin electrons. However, for same spin electrons, the second term of \eq{exchange} gives rise to a correlation effect: for electrons of the same spin-projection the first and second term cancel exactly for $\r_1=\r_2$ \cite{thijssen}\comment{p54}. This is known as \emph{exchange correlation}, all electrons are surrounded by \emph{exchange holes} where the chance of finding other like-spin electrons is drastically reduced. 

\section{The Hartree-Fock energy}
Assuming now the wave function takes the form of a single Slater determinant inhabited by \emph{orthonormal} orbitals, let us work out what the exected value of the energy is. The Hamiltonian consists of two parts\textemdash a one-body and a two-body term\textemdash which we will handle separately. 

\subsubsection{One-body Hamiltonian}
The electronic one-body part of the Hamiltonian takes the form
\begin{align}
\hat h=\sum_{i=1}^N\hat h_i = \sum_{i=1}^N\left[ -\frac{\nabla_i^2}{2}-\sum_{A=1}^M \frac{Z_A}{|\r_i-\r_A|}  \right],
\end{align}
where $M$ denotes the number of nuclei. Since $\hat h_i$ only acts on the coordinates of particle $i$, we find
\begin{align}
\langle \Psi|\hat h|\Psi\rangle &= \int\mathrm{d}^3\r_1\dots\mathrm{d}^3\r_N\, \Psi^*(\R)\sum_{i=1}^N\hat h_i \Psi(\R) \label{eq:hf1}
\end{align}
with terms 
\begin{align}
(\ref{eq:hf1}) &= \int \mathrm{d}^3\r_1\dots\mathrm{d}^3\r_N\, \Psi^*(\R) \hat h_k\Psi(\R) \nn\\
&= \frac{1}{N!} \int \mathrm{d}^3\r_1\dots\mathrm{d}^3\r_N\,\sum_{\mu,\nu\in S_N}(-1)^{|\mu|+|\nu|}\hat P_\mu \hat P_\nu \Psi^*(\r_{\mu(1)}\dots \r_{\mu(N)})\hat h_k \Psi(\r_{\nu(1)}\dots \r_{\nu(N)}) \nn\\
%
&= \frac{1}{N!}\sum_{\mu,\nu\in S_N}(-1)^{|\mu|+|\nu|} \hat P_\mu \hat P_\nu \delta_{\mu(1)}^{\nu(1)}\dots\delta_{\mu(k-1)}^{\nu(k-1)} \delta_{\mu(k+1)}^{\nu(k+1)}\dots\delta_{\mu(N)}^{\nu(N)}  \nn\\
%
& \phantom{-----------------}\times \int \mathrm{d}^3\r_k  \phi^*_{\mu(k)}(\r_k)\hat h_k \phi_{\nu(k)}(\r_k). \label{eq:hf2}
\end{align}
Here, $\hat P_\mu$ acts on the orbital indices of $\Psi^*(\R)$, while $\hat P_\nu$ acts on the corresponding indices of $\Psi(\R)$. Since all indices must appear exactly once, and there are $N-1$ delta functions, the only suriving terms appear for permutations which satisfy $\mu(k)=\nu(k)$. In fact, $\mu$ must be equal to $\nu$ on the whole, making $(-1)^{|\mu|+|\nu|}=+1$. 

In total, there are $N!$ possible permutations, meaning we have $(N-1)!$ permutations in the sum of \eq{hf2},
\begin{align}
(\ref{eq:hf2}) &= \frac{(N-1)!}{N!}\sum_{i=1}^N\int\mathrm{d}^3\r_k \phi_i^*(\r_k)\hat h_k \phi_i(\r_k) \nn\\
%
&= \frac{1}{N}\sum_{i=1}^N\int\mathrm{d}^3\r_k \phi_i^*(\r_k)\hat h_k \phi_i(\r_k). 
\end{align}
Since we have one such term for each $k$, we find in total that 
\begin{align}
\langle \Psi|\hat h|\Psi\rangle &= \sum_{i=1}^N\int\mathrm{d}^3\r\, \phi_i(\r)\hat h \phi_i(\r),
\end{align}
where we have omitted the subscript on $\hat h$. 

\subsection{The \emph{Hartree-Fock limit} \label{HFlimit}}


!!!!!!!

!!!!!!!

INSANE SHIT: 
Integrals:\url{https://github.com/psi4/psi4numpy/blob/master/Tutorials/11_Integrals/11a_1e_Integrals.ipynb}
RHF:\url{https://github.com/psi4/psi4numpy/blob/master/Tutorials/03_Hartree-Fock/3a_restricted-hartree-fock.ipynb}

!!!!!!!

!!!!!!!















 

\end{document}

% \begin{figure}[p!]
% \centering
% \includegraphics[width=12cm]{<fig>.pdf}
% \caption{\label{fig:1}}
% \end{figure}
 
% \lstinputlisting[firstline=1,lastline=2, float=p!, caption={}, label=lst:1]{<code>.m}

  